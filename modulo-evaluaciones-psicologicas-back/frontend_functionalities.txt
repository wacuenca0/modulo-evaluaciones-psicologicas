{
  "generatedAt": "2025-12-08",
  "globalConsiderations": [
    "Todas las peticiones (salvo login y utilidades de desarrollo) requieren enviar el token JWT en el encabezado Authorization como 'Bearer <token>'.",
    "Gestionar estados de carga y errores para respuestas 400/401/403/404/500; los servicios siguen convención REST estándar.",
    "Los campos con validaciones en backend (anotaciones jakarta.validation) deben reflejar restricciones equivalentes en los formularios frontend.",
    "Las fechas se intercambian en formato ISO-8601 (yyyy-MM-dd para LocalDate, yyyy-MM-dd'T'HH:mm:ss para LocalDateTime).",
    "La aplicación asume roles principales: ADMINISTRADOR, PSICOLOGO y OBSERVADOR (solo visualización)."
  ],
  "services": [
    {
      "name": "servicio-catalogos",
      "description": "Autenticación, gestión de usuarios/roles y catálogo CIE10.",
      "features": [
        {
          "id": "catalogos-auth-login",
          "summary": "Inicio de sesión y obtención del JWT",
          "endpoint": {
            "method": "POST",
            "path": "/api/auth/login",
            "auth": "public",
            "roles": [],
            "queryParams": [],
            "request": {
              "body": {
                "username": "string",
                "password": "string"
              }
            },
            "response": {
              "type": "string",
              "description": "Token JWT que se usará en llamadas posteriores."
            }
          },
          "uiHints": [
            "Formulario de login con recordatorio de credenciales.",
            "Persistir token en almacenamiento seguro (session/local storage) y refrescar cabeceras Axios/Fetch."
          ],
          "notes": [
            "Retorna 401 cuando las credenciales son inválidas."
          ]
        },
        {
          "id": "catalogos-auth-current-user",
          "summary": "Obtener datos del usuario autenticado",
          "endpoint": {
            "method": "GET",
            "path": "/api/auth/current-user",
            "auth": "required",
            "roles": ["ADMINISTRADOR", "PSICOLOGO", "OBSERVADOR"],
            "queryParams": [],
            "response": {
              "type": "UserDTO",
              "fields": {
                "id": "number",
                "username": "string",
                "email": "string",
                "roleId": "number"
              }
            }
          },
          "uiHints": [
            "Sincronizar estado global del usuario (por ejemplo, Redux/Context)."
          ],
          "notes": []
        },
        {
          "id": "catalogos-users-list",
          "summary": "Listado de usuarios registrados",
          "endpoint": {
            "method": "GET",
            "path": "/api/users",
            "auth": "required",
            "roles": ["ADMINISTRADOR"],
            "queryParams": [],
            "response": {
              "type": "array<UserDTO>",
              "fields": {
                "id": "number",
                "username": "string",
                "email": "string",
                "roleId": "number"
              }
            }
          },
          "uiHints": [
            "Tabla con filtros por username/email y acciones de edición/eliminación."
          ],
          "notes": []
        },
        {
          "id": "catalogos-users-create",
          "summary": "Crear nuevo usuario",
          "endpoint": {
            "method": "POST",
            "path": "/api/users",
            "auth": "required",
            "roles": ["ADMINISTRADOR"],
            "queryParams": [],
            "request": {
              "body": {
                "username": "string",
                "email": "string",
                "password": "string",
                "roleId": "number"
              }
            },
            "response": {
              "type": "UserDTO"
            }
          },
          "uiHints": [
            "Formulario con confirmación de contraseña opcional en frontend.",
            "Mostrar lista de roles disponibles (ver endpoint roles)."
          ],
          "notes": [
            "Validar unicidad de username/email antes de enviar (opcional async check)."
          ]
        },
        {
          "id": "catalogos-users-update",
          "summary": "Actualizar usuario existente",
          "endpoint": {
            "method": "PUT",
            "path": "/api/users",
            "auth": "required",
            "roles": ["ADMINISTRADOR"],
            "queryParams": [],
            "request": {
              "body": {
                "id": "number",
                "username": "string",
                "email": "string",
                "roleId": "number",
                "active": "boolean"
              }
            },
            "response": {
              "type": "UserDTO"
            }
          },
          "uiHints": [
            "Formulario de edición in-line o modal."
          ],
          "notes": []
        },
        {
          "id": "catalogos-users-delete",
          "summary": "Eliminar usuario por username",
          "endpoint": {
            "method": "DELETE",
            "path": "/api/users/{username}",
            "auth": "required",
            "roles": ["ADMINISTRADOR"],
            "queryParams": [],
            "response": {
              "type": "void"
            }
          },
          "uiHints": [
            "Confirmación modal antes de ejecutar."
          ],
          "notes": []
        },
        {
          "id": "catalogos-roles-list",
          "summary": "Obtener catálogo de roles disponibles",
          "endpoint": {
            "method": "GET",
            "path": "/api/roles",
            "auth": "required",
            "roles": ["ADMINISTRADOR"],
            "queryParams": [],
            "response": {
              "type": "array<RoleDTO>",
              "fields": {
                "id": "number",
                "name": "string"
              }
            }
          },
          "uiHints": [
            "Popular selectores en formularios de usuario."
          ],
          "notes": []
        },
        {
          "id": "catalogos-cie10-list",
          "summary": "Listado (filtrable) de diagnósticos CIE10",
          "endpoint": {
            "method": "GET",
            "path": "/api/catalogo-cie10",
            "auth": "required",
            "roles": ["ADMINISTRADOR", "PSICOLOGO"],
            "queryParams": [
              {
                "name": "soloActivos",
                "type": "boolean",
                "required": false,
                "description": "Cuando true, filtra únicamente registros activos."
              }
            ],
            "response": {
              "type": "array<CatalogoCIE10DTO>"
            }
          },
          "uiHints": [
            "Tabla buscable por código/descripción con paginación local."
          ],
          "notes": []
        },
        {
          "id": "catalogos-cie10-detail",
          "summary": "Detalle de diagnóstico CIE10",
          "endpoint": {
            "method": "GET",
            "path": "/api/catalogo-cie10/{id}",
            "auth": "required",
            "roles": ["ADMINISTRADOR", "PSICOLOGO"],
            "queryParams": [],
            "response": {
              "type": "CatalogoCIE10DTO"
            }
          },
          "uiHints": [
            "Vista de detalle o precarga para edición."
          ],
          "notes": []
        },
        {
          "id": "catalogos-cie10-create",
          "summary": "Crear diagnóstico CIE10",
          "endpoint": {
            "method": "POST",
            "path": "/api/catalogo-cie10",
            "auth": "required",
            "roles": ["ADMINISTRADOR"],
            "queryParams": [],
            "request": {
              "body": {
                "codigo": "string (max 10)",
                "descripcion": "string (max 500)",
                "activo": "boolean"
              }
            },
            "response": {
              "type": "CatalogoCIE10DTO"
            }
          },
          "uiHints": [
            "Validar longitud en frontend; mostrar switch de 'activo'."
          ],
          "notes": []
        },
        {
          "id": "catalogos-cie10-update",
          "summary": "Actualizar diagnóstico CIE10",
          "endpoint": {
            "method": "PUT",
            "path": "/api/catalogo-cie10/{id}",
            "auth": "required",
            "roles": ["ADMINISTRADOR"],
            "queryParams": [],
            "request": {
              "body": {
                "codigo": "string (max 10)",
                "descripcion": "string (max 500)",
                "activo": "boolean"
              }
            },
            "response": {
              "type": "CatalogoCIE10DTO"
            }
          },
          "uiHints": [
            "Formulario de edición reutilizable."
          ],
          "notes": []
        },
        {
          "id": "catalogos-dev-hash",
          "summary": "Generador de hash BCrypt (uso interno)",
          "endpoint": {
            "method": "GET",
            "path": "/api/dev/hash",
            "auth": "public",
            "roles": [],
            "queryParams": [
              {
                "name": "pwd",
                "type": "string",
                "required": true,
                "description": "Contraseña en texto plano."
              }
            ],
            "response": {
              "type": "object",
              "fields": {
                "password": "string",
                "bcryptHash": "string"
              }
            }
          },
          "uiHints": [
            "Puede ofrecerse como herramienta en ambiente dev, no exponer en prod."
          ],
          "notes": []
        }
      ]
    },
    {
      "name": "servicio-documentos",
      "description": "Gestión integral de fichas históricas y documentos adjuntos.",
      "features": [
        {
          "id": "documentos-tipos-list",
          "summary": "Listar tipos de documento",
          "endpoint": {
            "method": "GET",
            "path": "/api/documentos/tipos",
            "auth": "required",
            "roles": ["ADMINISTRADOR", "PSICOLOGO"],
            "queryParams": [],
            "response": {
              "type": "array<TipoDocumentoDTO>"
            }
          },
          "uiHints": [
            "Popular catálogos de selección al adjuntar documentos."
          ],
          "notes": []
        },
        {
          "id": "documentos-tipos-detail",
          "summary": "Detalle de tipo de documento",
          "endpoint": {
            "method": "GET",
            "path": "/api/documentos/tipos/{id}",
            "auth": "required",
            "roles": ["ADMINISTRADOR", "PSICOLOGO"],
            "queryParams": [],
            "response": {
              "type": "TipoDocumentoDTO"
            }
          },
          "uiHints": [],
          "notes": []
        },
        {
          "id": "documentos-tipos-create",
          "summary": "Crear tipo de documento",
          "endpoint": {
            "method": "POST",
            "path": "/api/documentos/tipos",
            "auth": "required",
            "roles": ["ADMINISTRADOR"],
            "queryParams": [],
            "request": {
              "body": {
                "nombre": "string",
                "descripcion": "string",
                "obligatorio": "boolean"
              }
            },
            "response": {
              "type": "TipoDocumentoDTO"
            }
          },
          "uiHints": [
            "Formulario simple con toggle de obligatoriedad."
          ],
          "notes": []
        },
        {
          "id": "documentos-tipos-update",
          "summary": "Actualizar tipo de documento",
          "endpoint": {
            "method": "PUT",
            "path": "/api/documentos/tipos/{id}",
            "auth": "required",
            "roles": ["ADMINISTRADOR"],
            "queryParams": [],
            "request": {
              "body": {
                "nombre": "string",
                "descripcion": "string",
                "obligatorio": "boolean"
              }
            },
            "response": {
              "type": "TipoDocumentoDTO"
            }
          },
          "uiHints": [],
          "notes": []
        },
        {
          "id": "documentos-tipos-delete",
          "summary": "Eliminar tipo de documento",
          "endpoint": {
            "method": "DELETE",
            "path": "/api/documentos/tipos/{id}",
            "auth": "required",
            "roles": ["ADMINISTRADOR"],
            "queryParams": [],
            "response": {
              "type": "void"
            }
          },
          "uiHints": [
            "Confirmar si hay documentos asociados antes de eliminar (validación manual)."
          ],
          "notes": []
        },
        {
          "id": "documentos-fichas-list-by-cedula",
          "summary": "Obtener fichas históricas por cédula",
          "endpoint": {
            "method": "GET",
            "path": "/api/documentos/fichas-historicas",
            "auth": "required",
            "roles": ["ADMINISTRADOR", "PSICOLOGO"],
            "queryParams": [
              {
                "name": "cedula",
                "type": "string",
                "required": true,
                "description": "Número de cédula del personal militar."
              }
            ],
            "response": {
              "type": "array<FichaHistoricaDTO>"
            }
          },
          "uiHints": [
            "Formulario de búsqueda por cédula con resultados ordenados por fechaEvaluacion descendente."
          ],
          "notes": []
        },
        {
          "id": "documentos-fichas-detail",
          "summary": "Consultar ficha histórica por ID",
          "endpoint": {
            "method": "GET",
            "path": "/api/documentos/fichas-historicas/{id}",
            "auth": "required",
            "roles": ["ADMINISTRADOR", "PSICOLOGO"],
            "queryParams": [],
            "response": {
              "type": "FichaHistoricaDTO"
            }
          },
          "uiHints": [
            "Renderizar ficha completa con secciones colapsables."
          ],
          "notes": []
        },
        {
          "id": "documentos-fichas-create",
          "summary": "Registrar nueva ficha histórica",
          "endpoint": {
            "method": "POST",
            "path": "/api/documentos/fichas-historicas",
            "auth": "required",
            "roles": ["PSICOLOGO", "ADMINISTRADOR"],
            "queryParams": [],
            "request": {
              "body": "FichaHistoricaDTO"
            },
            "response": {
              "type": "FichaHistoricaDTO"
            }
          },
          "uiHints": [
            "Wizard de varias pestañas (identificación, historia clínica, historia psicológica, evaluación, recomendaciones).",
            "Permitir guardar en estado BORRADOR antes de completar todos los campos obligatorios."
          ],
          "notes": [
            "Validar enumeraciones enviadas (EstadoFicha, EstadoCivil, etc.)."
          ]
        },
        {
          "id": "documentos-fichas-update",
          "summary": "Actualizar ficha histórica",
          "endpoint": {
            "method": "PUT",
            "path": "/api/documentos/fichas-historicas/{id}",
            "auth": "required",
            "roles": ["PSICOLOGO", "ADMINISTRADOR"],
            "queryParams": [],
            "request": {
              "body": "FichaHistoricaDTO"
            },
            "response": {
              "type": "FichaHistoricaDTO"
            }
          },
          "uiHints": [
            "Permitir edición parcial conservando valores previos."
          ],
          "notes": []
        },
        {
          "id": "documentos-fichas-delete",
          "summary": "Eliminar ficha histórica",
          "endpoint": {
            "method": "DELETE",
            "path": "/api/documentos/fichas-historicas/{id}",
            "auth": "required",
            "roles": ["ADMINISTRADOR"],
            "queryParams": [],
            "response": {
              "type": "void"
            }
          },
          "uiHints": [
            "Solicitar doble confirmación dada la eliminación permanente."
          ],
          "notes": []
        },
        {
          "id": "documentos-list-by-ficha",
          "summary": "Listar documentos activos asociados a una ficha",
          "endpoint": {
            "method": "GET",
            "path": "/api/documentos/fichas/{fichaId}/documentos",
            "auth": "required",
            "roles": ["ADMINISTRADOR", "PSICOLOGO"],
            "queryParams": [],
            "response": {
              "type": "array<DocumentoFichaDTO>"
            }
          },
          "uiHints": [
            "Listado con enlaces de descarga (rutaArchivo) y metadatos (fechaSubida, tipoDocumento)."
          ],
          "notes": []
        },
        {
          "id": "documentos-detail",
          "summary": "Obtener documento adjunto por ID",
          "endpoint": {
            "method": "GET",
            "path": "/api/documentos/documentos/{id}",
            "auth": "required",
            "roles": ["ADMINISTRADOR", "PSICOLOGO"],
            "queryParams": [],
            "response": {
              "type": "DocumentoFichaDTO"
            }
          },
          "uiHints": [
            "Mostrar vista previa si el archivo es compatible (PDF/imágenes)."
          ],
          "notes": []
        },
        {
          "id": "documentos-create",
          "summary": "Registrar documento adjunto",
          "endpoint": {
            "method": "POST",
            "path": "/api/documentos/documentos",
            "auth": "required",
            "roles": ["ADMINISTRADOR", "PSICOLOGO"],
            "queryParams": [],
            "request": {
              "body": {
                "fichaId": "number",
                "tipoDocumentoId": "number",
                "nombreArchivo": "string",
                "rutaArchivo": "string",
                "descripcion": "string",
                "fechaSubida": "date",
                "tamano": "number",
                "activo": "boolean"
              }
            },
            "response": {
              "type": "DocumentoFichaDTO"
            }
          },
          "uiHints": [
            "Integrar con carga de archivos (gestión de rutaArchivo y almacenamiento real).",
            "Solicitar tipo de documento desde catálogo.",
            "Asignar fechaSubida automáticamente en frontend si no se especifica."
          ],
          "notes": []
        },
        {
          "id": "documentos-update",
          "summary": "Actualizar metadatos de documento",
          "endpoint": {
            "method": "PUT",
            "path": "/api/documentos/documentos/{id}",
            "auth": "required",
            "roles": ["ADMINISTRADOR", "PSICOLOGO"],
            "queryParams": [],
            "request": {
              "body": {
                "fichaId": "number",
                "tipoDocumentoId": "number",
                "nombreArchivo": "string",
                "rutaArchivo": "string",
                "descripcion": "string",
                "fechaSubida": "date",
                "tamano": "number",
                "activo": "boolean"
              }
            },
            "response": {
              "type": "DocumentoFichaDTO"
            }
          },
          "uiHints": [
            "Permitir actualización de estado activo/inactivo."
          ],
          "notes": []
        },
        {
          "id": "documentos-delete",
          "summary": "Inactivar documento adjunto",
          "endpoint": {
            "method": "DELETE",
            "path": "/api/documentos/documentos/{id}",
            "auth": "required",
            "roles": ["ADMINISTRADOR", "PSICOLOGO"],
            "queryParams": [],
            "response": {
              "type": "void"
            }
          },
          "uiHints": [
            "Interpretar como baja lógica (campo activo=false); mantener indicador en UI."
          ],
          "notes": []
        }
      ]
    }
  ],
  "enumerations": {
    "EstadoFicha": ["BORRADOR", "EN_PROCESO", "FINALIZADA", "ANULADA"],
    "EstadoCivil": ["SOLTERO", "CASADO", "UNION_LIBRE", "DIVORCIADO", "SEPARADO", "VIUDO"],
    "NivelInstruccion": ["PRIMARIA", "SECUNDARIA", "TECNICA", "TECNOLOGICA", "SUPERIOR", "CUARTO_NIVEL", "OTRO"],
    "Religion": ["CATOLICA", "CRISTIANA", "EVANGELICA", "ADVENTISTA", "TESTIGOS_DE_JEHOVA", "MORMONA", "JUDAISMO", "ISLAM", "SIN_RELIGION", "OTRA"],
    "TipoSangre": ["O_POS", "O_NEG", "A_POS", "A_NEG", "B_POS", "B_NEG", "AB_POS", "AB_NEG"]
  },
  "dtoSchemas": {
    "FichaHistoricaDTO": {
      "datosIdentificacion": {
        "numeroFicha": "string",
        "numeroCedula": "string",
        "apellidosNombres": "string",
        "sexo": "string",
        "estadoCivil": "EstadoCivil",
        "nivelInstruccion": "NivelInstruccion",
        "grado": "string",
        "armaServicio": "string",
        "unidad": "string",
        "grupoCompania": "string",
        "cargoActual": "string",
        "fechaIngreso": "date",
        "tiempoServicioAnios": "number",
        "fechaNacimiento": "date",
        "edadActual": "number",
        "numeroHijos": "number",
        "ocupacion": "string",
        "especialidad": "string",
        "religion": "Religion",
        "tipoSangre": "TipoSangre",
        "domicilioProvincia": "string",
        "domicilioCanton": "string",
        "domicilioParroquia": "string",
        "domicilioBarrio": "string",
        "telefono": "string",
        "celular": "string",
        "email": "string",
        "contactoEmergencia": "string",
        "telefonoEmergencia": "string"
      },
      "historiaClinica": {
        "antecedentesPersonales": "string",
        "antecedentesFamiliares": "string",
        "enfermedadesActuales": "string",
        "tratamientosPrevios": "string",
        "cirugiasPrevias": "string",
        "hospitalizacionesPrevias": "string",
        "alergias": "string",
        "medicacionActual": "string",
        "consumoSustancias": "string",
        "habitosSalud": "string",
        "suenoDescripcion": "string",
        "horasSueno": "number",
        "alimentacion": "string",
        "actividadFisica": "string"
      },
      "historiaPsicologica": {
        "motivoConsulta": "string",
        "historiaProblema": "string",
        "contextoFamiliar": "string",
        "contextoSocial": "string",
        "contextoLaboral": "string",
        "eventosSignificativos": "string",
        "antecedentesPsicologicos": "string",
        "antecedentesPsiquiatricos": "string",
        "redApoyo": "string",
        "intervencionesPrevias": "string",
        "observacionesPsicosociales": "string"
      },
      "evaluacionPsicologica": {
        "evaluacionCognitiva": "string",
        "evaluacionEmocional": "string",
        "evaluacionConductual": "string",
        "evaluacionFamiliar": "string",
        "pruebasAplicadas": "string",
        "resultadosPruebas": "string",
        "diagnosticoDsm": "string",
        "diagnosticoCie10": "string",
        "reporteRiesgos": "string",
        "observacionesEvaluacion": "string"
      },
      "recomendacionProfesional": {
        "planIntervencion": "string",
        "objetivosTerapeuticos": "string",
        "intervencionesPropuestas": "string",
        "derivaciones": "string",
        "recomendacionesGenerales": "string",
        "fechaProximaCita": "date",
        "responsableNombre": "string",
        "responsableCargo": "string",
        "responsableIdentificacion": "string",
        "firmaDigitalHash": "string",
        "observacionesFinales": "string"
      },
      "estadoFicha": "EstadoFicha",
      "fechaEvaluacion": "date",
      "psicologoResponsable": "string",
      "dependenciaSolicitante": "string",
      "observacionesGenerales": "string",
      "creadoPor": "string",
      "actualizadoPor": "string",
      "createdAt": "datetime",
      "updatedAt": "datetime"
    },
    "DocumentoFichaDTO": {
      "id": "number",
      "fichaId": "number",
      "tipoDocumentoId": "number",
      "nombreArchivo": "string",
      "rutaArchivo": "string",
      "descripcion": "string",
      "fechaSubida": "date",
      "tamano": "number",
      "activo": "boolean",
      "createdAt": "datetime"
    },
    "TipoDocumentoDTO": {
      "id": "number",
      "nombre": "string",
      "descripcion": "string",
      "obligatorio": "boolean"
    },
    "CatalogoCIE10DTO": {
      "id": "number",
      "codigo": "string",
      "descripcion": "string",
      "activo": "boolean"
    },
    "UserDTO": {
      "id": "number",
      "username": "string",
      "email": "string",
      "roleId": "number"
    }
  },
  "pendingIntegrations": [
    {
      "module": "servicio-gestion",
      "status": "sin endpoints activos",
      "notes": "Los controladores actuales son marcadores en blanco; el frontend debe esperar nueva API para gestionar personal militar y psicólogos."
    }
  ]
}
