MODELO UNIFICADO PSICÓLOGO + USUARIO
===================================

Contexto
--------
- El servicio de gestión ahora es dueño del perfil completo del psicólogo.
- Ya no existe la columna usuario_id ni sus dependencias directas.
- El username se considera el identificador transversal entre módulos (gestión, catálogos y gateway).

Campos persistidos en psicologos
--------------------------------
- cedula (string, único, requerido)
- nombres (string, requerido)
- apellidos (string, requerido)
- apellidosNombres (string, autogenerado por el backend al persistir)
- username (string, único, requerido, se inicializa como "psicologo_<id>" si no se recibe)
- email (string, opcional)
- telefono / celular (string, opcional)
- grado (string, opcional)
- especialidad (string, opcional)
- unidadMilitar (string, opcional)
- activo (boolean, true por defecto)
- createdAt / updatedAt (timestamp, gestionados automáticamente)

Contrato REST (servicio-gestion)
--------------------------------
POST /api/psicologos
```
{
  "cedula": "1712345678",
  "nombres": "María Fernanda",
  "apellidos": "García López",
  "username": "mfgarcia",
  "email": "maria.garcia@dominio.mil.ec",
  "telefono": "023456789",
  "celular": "0991234567",
  "grado": "TCnl.",
  "especialidad": "Psicología Clínica",
  "unidadMilitar": "Hospital Militar Quito",
  "activo": true
}
```

Respuesta 201:
```
{
  "id": 25,
  "cedula": "1712345678",
  "nombres": "María Fernanda",
  "apellidos": "García López",
  "apellidosNombres": "García López María Fernanda",
  "username": "mfgarcia",
  "email": "maria.garcia@dominio.mil.ec",
  "telefono": "023456789",
  "celular": "0991234567",
  "grado": "TCnl.",
  "especialidad": "Psicología Clínica",
  "unidadMilitar": "Hospital Militar Quito",
  "activo": true,
  "createdAt": "2025-01-05T12:34:56",
  "updatedAt": "2025-01-05T12:34:56"
}
```

Notas importantes
-----------------
- El backend recalcula apellidosNombres en cada alta o actualización.
- deleteById ahora realiza baja lógica (activo=false) para preservar histórico.
- /api/psicologos GET solo lista registros activos ordenados por apellidosNombres.
- AuthenticatedPsicologoProvider auto-provisiona un psicólogo activo usando username + displayName del token si no existe, reactivando cuentas inactivas.
- Reportes y fichas toman el nombre visible desde apellidosNombres garantizando consistencia.
- La migración database/migrations/20260107_update_psicologos_profile.sql debe ejecutarse antes de desplegar para ajustar la tabla y disparadores.

Integración desde servicio-catalogos
------------------------------------
- UserServiceImpl arma PsicologoCreateRequest con nombres y apellidos reales.
- El campo username se alinea con el username del nuevo usuario.
- Email del psicólogo reutiliza el email del usuario en la solicitud de alta.
- Datos opcionales (grado, especialidad, unidadMilitar, teléfonos) se propagan cuando están disponibles.

Checklist de despliegue
-----------------------
1. Mantener `spring.jpa.hibernate.ddl-auto=update` (Hibernate agrega las columnas nuevas automáticamente).
2. Desplegar servicio-gestion (nuevos endpoints + modelo).
3. Desplegar servicio-catalogos (payload extendido al crear usuarios).
4. Revisar logs del proveedor autenticado para validar auto-provision posterior al login.
5. Actualizar Postman/colecciones compartidas con el nuevo JSON de psicólogo.
