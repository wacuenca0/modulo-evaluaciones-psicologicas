FICHA PSICOLOGICA - REGLAS BACKEND (SERVICIO-GESTION)
=====================================================

1. Identificadores obligatorios
   - personal_militar_id: debe existir en la tabla PERSONAL_MILITAR.
   - psicólogo: se toma del usuario autenticado (token); no enviar psicologo_id manualmente.

2. Campos de fechas y texto
   - fecha_evaluacion: formato ISO (yyyy-MM-dd). Si es nulo, el backend usa la fecha actual.
   - numero_historia_clinica: texto obligatorio, máximo 50 caracteres.
   - observacion_clinica y motivo_consulta: obligatorios (CLOB). Use texto no vacío.
   - plan_detalle: máximo 500 caracteres (obligatorio cuando la condición lo exige).
   - diagnostico_cie10_codigo: obligatorio cuando la condición requiere plan, máximo 10 caracteres (se normaliza a mayúsculas).

3. Booleans requeridos (enviar true/false)
   - toma_medicacion
   - hospitalizacion_rehabilitacion
   - parto_normal
   - discapacidad_intelectual_presenta
   - tratamientos_previos_ha_recibido
   - exposicion_intrauterina (opcional, default false)

4. Enums soportados por el backend (usar alguno de los tokens indicados)

   4.1 tipo_evaluacion (TipoEvaluacionEnum)
       - "Valoracion porte armas"
       - "Evaluacion anual"
       - "Ingreso"
       - "Reintegro"
       - "Evaluacion especial"
       - "Otro"

   4.2 estado (EstadoFichaEnum)
       - "Activa"
       - "Abierta"
       - "En seguimiento"
       - "Observacion"
       - "Cerrada"
       - "Archivada"
       - "Otro"

   4.3 condicion (CondicionClinicaEnum)
       - "Alta" (alias de "No presenta psicopatologia (Alta)")
       - "Seguimiento" (Requiere plan obligatorio)
       - "Transferencia" (Requiere plan obligatorio)

   4.4 grado_sociabilidad (GradoSociabilidadEnum) – opcional
       - "Introvertido"
       - "Reservado"
       - "Neutral"
       - "Comunicativo"
       - "Extrovertido"
       - "Otro"

   4.5 relacion_familiar (RelacionFamiliarEnum) – opcional
       - "Asertiva"
       - "Conflictiva"
       - "Distante"
       - "Sobreprotectora"
       - "Inexistente"
       - "Otro"

   4.6 discapacidad_intelectual_grado (GradoDiscapacidadEnum) – opcional
       - "Ninguna"
       - "Leve"
       - "Moderado"
       - "Grave"
       - "Profundo"

   4.7 plan_frecuencia (FrecuenciaSeguimientoEnum) – requerido si condicion es Seguimiento o Transferencia
       - "Semanal"
       - "Quincenal"
       - "Mensual"
       - "Bimestral"
       - "Trimestral"
       - "Personalizada"

   4.8 plan_tipo_sesion (TipoSesionEnum) – requerido si condicion es Seguimiento o Transferencia
       - "Individual"
       - "Grupal"
       - "Familiar"
       - "Pareja"
       - "Remota"
       - "Mixta"

5. Reglas adicionales de negocio
   - Cuando condicion es "Seguimiento" o "Transferencia":
       * Diagnostico CIE-10 (codigo + descripcion) obligatorio.
       * plan_frecuencia, plan_tipo_sesion y plan_detalle obligatorios.
   - Para condicion "Alta": el backend ignora plan y diagnostico, aunque se envíen.
   - Valores de texto se trimean; enviar cadenas vacías provoca errores de validación.

6. Validaciones de base de datos relevantes (Oracle)
   - Restricciones CHECK para estado, condicion, plan_frecuencia y plan_tipo_sesion sólo aceptan los valores listados arriba.
   - Violaciones generan ORA-02290 (control constraint). Ajustar la UX para enviar únicamente valores válidos.

7. Recomendaciones para el frontend
   - Usar listas desplegables basadas en este catálogo.
   - Validar longitud de campos antes de enviar.
   - Enviar fechas en ISO 8601 (yyyy-MM-dd).
   - Asegurarse de que los booleanos lleguen como true/false (no strings).
   - Renovar el token JWT tras cambios en credenciales para incluir userId/usuarioId.
